#!/usr/bin/env php
<?php
/**
 * CLI actions processor
 */

use App\Service\Application;

require_once __DIR__ . '/../config/bootstrap.php';

$container = (new Application())->boot()->container();

$action = $argv[1] ?? 'help';
switch ($action) {
    case 'reset':
        $container->redis()->flushAll();
        echo 'Redis DB was successfully flushed.' . PHP_EOL;
        break;

    default:
        show_help($argv);
}

/**
 * Show help on command usage
 * @param array $argv
 * @return never
 */
function show_help(array $argv): never {
    echo 'Run CLI commands' . PHP_EOL;
    echo $argv[0] . " {help}" . PHP_EOL . PHP_EOL;
    echo "Commands:" . PHP_EOL;
    echo "    reset - reset all DBs" . PHP_EOL;
    echo "    help - show help info" . PHP_EOL;
    exit(0);
}

exit(0);
